---
title: "R Notebook"
output: html_notebook
---


Set up the libraries;
```{r}
library(tidyverse)
library(scales)
```

```{r}
backpack <- CodeClanData::backpack %>% janitor::clean_names()
```




# Question 1.

Load in the libraries you need, and look at the backpack data. Take note of 
variable names and dimensions.


Backpack contains 100 observations of 9 variables, detailing various students, 
their gender <fct>, subject of study <fct>, body weight <int>, their backpack 
weights <int>, an indication of back pain <int> and some details such as "units" 
<int> and "status" <fct> by year <int>.

# Question 2.

What is the distribution of backpack weights that students are carrying? Choose 
an appropriate graph to show the distribution.

A histogram would be a reasonable plot to show backpackweight distribution;

```{r}
backpack %>% 
  ggplot() +
  aes(x = backpack_weight) +
  geom_histogram(colour = "black", fill = "darkolivegreen4") +
  theme_bw(base_size = 11) +
  scale_y_continuous(breaks = 1:13) +
  labs(title = "Distribution of Backpack Weights",
       x = "\nBackpack Weight",
       y = "Count")
```
The distribution of backpack weights is right skewed with one obvious outlier at 35.



# Question 3.

Are there differences in backpack weight between sex?


A good way to compare between means and ranges between sexes would be a boxplot.


```{r}
backpack %>% 
  ggplot() +
  aes(x = sex, y = backpack_weight, group = sex, colour = sex, fill = sex) +
  geom_boxplot(colour = "black") +
  theme_classic(base_size = 11) +
  labs(title = "Backpack Weights by Gender",
       x = "Gender",
       y = "Backpack Weight")
```
Overall the males show a greater tendency to carry heavier weights, but the overall
medians and distributions are very similar.

# Question 4.

What is the relationship between body weight and backpack weight?

Scatterplots are often a good way to see if there are relationships between data;

```{r}
backpack %>% 
  ggplot() +
  aes(x = body_weight, y = backpack_weight) +
  geom_point(colour = "grey50") +
  theme_classic(base_size = 11) +
  labs(title = "Backpack Weight v Body Weight",
       x = "\nBody Weight",
       y = "Backpack Weight")
```
There's no immediately obvious trend shown by this chart.


# Question 5.

Is this relationship different between men and women? Choose an appropriate plot and interpret your findings.

Use the same basic scatterplot configuration, but grouped by gender;


```{r}
backpack %>% 
  ggplot() +
  aes(x = body_weight, y = backpack_weight, group = sex, colour = sex) +
  geom_point() +
  theme_classic(base_size = 11) +
  labs(title = "Backpack Weight v Body Weight by Gender",
       x = "\nBody Weight",
       y = "Backpack Weight"
       )
```

Even splitting the results by gender does not show any immediately obvious
relationship between body weight and backpack weight.

# Question 6.

What proportion of students report back pain?

Normally a calculation would be easier to show this than a graph...

```{r}
backpack %>% 
  filter(back_problems == 1) %>% 
  summarise(n())
```
32 students report back pain...

```{r}
backpack %>% 
  summarise(n())
```
...out of 100 = 32%.

Graphically;


```{r}
backpack %>% 
  ggplot() +
  aes(x = back_problems, group = back_problems) +
  geom_bar(colour = "black", position = "dodge", fill = "darkolivegreen4") +
  theme_light(base_size = 11) +
  scale_x_continuous(breaks = 0:1, labels = c("No", "Yes")) +
  scale_y_continuous(breaks = seq(0, 70, by = 5)) +
  labs(title = "Reports of Back Problems",
       x = "\nBack Problem Reported?",
       y = "Count"
       )


```
The number of students reporting back problems was 32.

The number of students *not* reporting back problems was 68.

The overall proportion of students reporting pain was therefore 32%.


I tried various ways to represent this, but because there's only one variable I 
struggled to show data labels on the graph.  How do you refer to "count" when it's
being generated by ggplot without any external calculation?  Is it necessary to 
`summarise(sum(back_problems))` beforehand and use that for labelling?



# Question 7.

Is this proportion different between men and women?

```{r}
backpack %>% 
  ggplot() +
  aes(x = back_problems, group = sex, fill = sex, size = back_problems) +
  geom_bar(colour = "black") +
  theme_light(base_size = 11) +
  scale_x_continuous(breaks = 0:1, labels = c("No", "Yes")) +
  scale_y_continuous(breaks = seq(0, 70, by = 5)) +
  labs(title = "Reports of Back Problems by Gender",
       x = "\nBack Problem Reported?",
       y = "Count"
       )
```
The graph shows that a far higher proportion (~ 45%) of females reported back 
problems than compared to males (~ 18%).

I'm not convinced this was the best graph type to use for this!  `geom_bar` and 
`geom_histogram` don't take data labelling very easily from what I can see...





# Question 8.

Now youâ€™ve investigated your data separately, create plots to describe the relationship between backpack weight, body weight, gender and reported backpain.

Try both backpack_weight and body_weight as well as the ratio.

Hint: faceting would be useful here.

```{r}
backpack %>% 
  ggplot() +
  aes(x = body_weight, y = backpack_weight) + 
    geom_point(colour = "grey40") +
    facet_grid(back_problems ~ sex, labeller = "label_both") +
    theme_bw(base_size = 11) + 
    labs(title = "Indication of Backpack Weight v Body Weight \nby Gender and Reported Back Problems",
         x = "Body Weight",
         y = "Backpack Weight"
         )
```

These charts show that the females who reported *no* back problems were of fairly 
typical body weight for females and had a backpack weight up to around 17.  Several
of the females who *did* report back poblems had heavier backpacks for similar body 
weight.

Males who reported *no* back pain had a wide spread of body weights and pack weights.

Males who *did* report problems were of fairly average body weight and pack weight
relative to the whole male group.